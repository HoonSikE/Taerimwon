<template>
  <div class="">
    <div class="title2">
      â— {{type}} ê°ì¸ ì¢…ë¥˜
    </div>
    <div class="text-align-center">
      <span class="link-item-color">
        <!-- ì¼ë°˜ -->
        <div v-if="type === 'ì¼ë°˜'">
          <button
            class="link-item"
            :class="{ selected: selectedType === 'ì¼ë°˜' }"
            @click="selectedType = 'ì¼ë°˜', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ì¼ë°˜.png" width="80" height="130" alt="ì¼ë°˜">
            <span class="selectText">[ê¸°ë³¸]</span>
          </button>
          <button
            class="link-item"
            :class="{ selected: selectedType === 'í˜•ì œ' }"
            @click="selectedType = 'í˜•ì œ', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ì¼ë°˜(í˜•ì œ).png" width="80" height="130" alt="í˜•ì œ">
            <span class="selectText">[í˜•ì œ]</span>
          </button>
        </div>
        <!-- ê¸°ë…êµ -->
        <div v-if="type === 'ê¸°ë…êµ'">
          <button
            class="link-item"
            :class="{ selected: selectedType === 'ì§ë¶„' }"
            @click="selectedType = 'ì§ë¶„', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ê¸°ë…êµ.png" width="80" height="130" alt="ê¸°ë…êµ(ì§ë¶„)">
            <span class="selectText">[ê¸°ë³¸]</span>
          </button>
          <button
            class="link-item"
            :class="{ selected: selectedType === 'ê¸°ë…êµ' }"
            @click="selectedType = 'ê¸°ë…êµ', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ê¸°ë…êµ(ì§ë¶„x).png" width="80" height="130" alt="ê¸°ë…êµ(ì§ë¶„x)">
            <span class="selectText">[ì§ë¶„X]</span>
          </button>
        </div>
        <!-- ë¶ˆêµ -->
        <div v-if="type === 'ë¶ˆêµ'">
          <button
            class="link-item"
            :class="{ selected: selectedType === 'ë¶ˆêµ' }"
            @click="selectedType = 'ë¶ˆêµ', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ë¶ˆêµ.png" width="80" height="130" alt="ë¶ˆêµ">
            <span class="selectText">[ê¸°ë³¸]</span>
          </button>
          <button
            class="link-item"
            :class="{ selected: selectedType === 'ë²•ëª…' }"
            @click="selectedType = 'ë²•ëª…', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ë¶ˆêµ(ë²•ëª…).png" width="80" height="130" alt="ë¶ˆêµ(ë²•ëª…)">
            <span class="selectText">[ë²•ëª…]</span>
          </button> 
        </div>
        <!-- ì²œì£¼êµ -->
        <div v-if="type === 'ì²œì£¼êµ'">
          <button
            class="link-item"
            :class="{ selected: selectedType === 'ì„¸ë¡€ëª…' }"
            @click="selectedType = 'ì„¸ë¡€ëª…', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ì²œì£¼êµ.png" width="80" height="130" alt="ì²œì£¼êµ(ì„¸ë¡€ëª…)">
            <span class="selectText">[ê¸°ë³¸]</span>
          </button>
          <button
            class="link-item"
            :class="{ selected: selectedType === 'ì²œì£¼êµ' }"
            @click="selectedType = 'ì²œì£¼êµ', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ì²œì£¼êµ(ì„¸ë¡€ëª…x).png" width="80" height="130" alt="ì²œì£¼êµ)">
            <span class="selectText">[ì„¸ë¡€ëª…X]</span>
          </button>
        </div>
        <!-- SGI -->
        <div v-if="type === 'SGI'">
          <button
            class="link-item"
            :class="{ selected: selectedType === 'SGI' }"
            @click="selectedType = 'SGI', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/sgi.png" width="80" height="130" alt="SGI">
            <span class="selectText">[ê¸°ë³¸]</span>
          </button>
        </div>
        <!-- ë¬˜ë²• -->
        <div v-if="type === 'ë¬˜ë²•'">
          <button
            class="link-item"
            :class="{ selected: selectedType === 'ë¬˜ë²•' }"
            @click="selectedType = 'ë¬˜ë²•', showRouterView = true"
          >
            <img src="../../../assets/images/engrave/example/ë¬˜ë²•.png" width="80" height="130" alt="ë¬˜ë²•">
            <span class="selectText">[ê¸°ë³¸]</span>
          </button>
        </div>
      </span>
    </div>
    <!-- ì •ë³´ì…ë ¥ -->
    <div class="text-align-center">
      <span class="info-text-align-center">
        <div class="title3">
          ì •ë³´ ì…ë ¥
        </div>
        <span class="input-info1">
          <div>
            ê³ ì¸ì„±í•¨&nbsp;
          </div>
          <div v-if="selectedType === 'ì§ë¶„'">
            ì§ë¶„&nbsp;
          </div>
          <div v-if="selectedType === 'ë²•ëª…'">
            ë²•ëª…&nbsp;
          </div>
          <div v-if="selectedType === 'ì„¸ë¡€ëª…'">
            ì„¸ë¡€ëª…&nbsp;
          </div>
          <!-- ë‚ ì§œ ì…ë ¥ -->
          <div>
            ì¶œìƒì¼&nbsp;
          </div>
          <div>
            ì‚¬ë§ì¼&nbsp;
          </div>
        </span>
        <span class="input-info2">
          <div>
            <input v-model="name1" type="text" :placeholder="defaultName1Placeholder"/>
          </div>
          <div v-if="selectedType === 'ì§ë¶„' || selectedType === 'ë²•ëª…' || selectedType === 'ì„¸ë¡€ëª…'">
            <input v-model="name2" type="text" :placeholder="defaultName2Placeholder"/>
          </div>
          <div>
            <!-- <input v-model="date1" type="date" placeholder="1900-01-01"/> -->
            <input v-model="date1_1" type="text" placeholder="ë…„ë„" style="width: 4em;">.
            <input v-model="date1_2" type="text" placeholder="ì›”" style="width: 2em;">.
            <input v-model="date1_3" type="text" placeholder="ì¼" style="width: 2em;">.&nbsp;
            <!-- ë‚ ì§œ ì…ë ¥ -->
            <select name="date1Type" v-model="date1Type">
              <option value="ì–‘ë ¥" selected="selected">ì–‘ë ¥</option>
              <option value="ìŒë ¥">ìŒë ¥</option>
            </select>
          </div>
          <div>
            <input v-model="date2_1" type="text" placeholder="ë…„ë„" style="width: 4em;">.
            <input v-model="date2_2" type="text" placeholder="ì›”" style="width: 2em;">.
            <input v-model="date2_3" type="text" placeholder="ì¼" style="width: 2em;">.&nbsp;
            <select name="date2Type" v-model="date2Type">
              <option value="ì–‘ë ¥" selected="selected">ì–‘ë ¥</option>
              <option value="ìŒë ¥">ìŒë ¥</option>
            </select>
          </div>
        </span>
      </span>
    </div>
    <hr>
    <div v-if="showRouterView">
      <div v-if="showName1KoreanWarning" class="warning_text">
        - ì„±í•¨ì„ í•œêµ­ì–´ë¡œ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else-if="showName1Warning" class="warning_text">
        - ì„±í•¨ì„ 2~4ê¸€ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else-if="showName2KoreanWarning && (selectedType === 'ì§ë¶„' || selectedType === 'ë²•ëª…' || selectedType === 'ì„¸ë¡€ëª…')" class="warning_text">
        - {{selectedType}}ì„ í•œêµ­ì–´ë¡œ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else-if="showName2Warning && (selectedType === 'ì§ë¶„' || selectedType === 'ë²•ëª…')" class="warning_text">
        - {{selectedType}}ì„ 2~4ê¸€ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else-if="showName3Warning && (selectedType === 'ì„¸ë¡€ëª…')" class="warning_text">
        - {{selectedType}}ì„ 2~6ê¸€ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else-if="showDate1_2Warning" class="warning_text">
        - ì¶œìƒì¼ì„ ì›”ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else-if="showDate1_3Warning" class="warning_text">
        - ì¶œìƒì¼ì„ ì¼ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else-if="showDate2_2Warning" class="warning_text">
        - ì‚¬ë§ì¼ì„ ì›”ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else-if="showDate2_3Warning" class="warning_text">
        - ì‚¬ë§ì¼ì„ ì¼ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.
      </div>
      <div v-else>
        <div v-if="type !== 'SGI' && type !== 'ë¬˜ë²•'">
          <RouterLink :to="'/engrave/engraveCreate/engraveDetail/tabletCreate?' + 'type=' + type 
                          + '&name1=' + encodedName1 + '&name2=' + encodedName2 
                          + '&date1=' + encodedDate1 + '&date1Type=' + date1Type 
                          + '&date2=' + encodedDate2 + '&date2Type=' + date2Type
                          + '&selectedType=' + selectedType"
                      @click="toggleRouterView">
            <div class="title4">
              ğŸ‘‰ ìœ„íŒ¨ ì£¼ë¬¸í•˜ê¸°
              <span class="title4_1">
                (Click!!)
              </span>
            </div>
          </RouterLink>
        </div>
        <router-link :to="'/engrave/result?' + 'type=' + type 
                + '&name0=' + 'ì—†ìŒ' + '&name1=' + encodedName1 + '&name2='+ encodedName2 
                + '&date1=' + encodedDate1 + '&date1Type=' + date1Type 
                + '&date2=' + encodedDate2 + '&date2Type=' + date2Type
                + '&selectedType=' + selectedType + '&selectedType2=ì—†ìŒ'" class="title4">ğŸ‘‰ ì˜ˆì‹œ ë³´ê¸° (ê°ì¸)</router-link>
      </div>
    </div>
    <div v-if="!showRouterView">
      <div class="title5" @click="toggleRouterView">ğŸ‘‰ ìœ„íŒ¨ ì£¼ë¬¸í•˜ì§€ ì•Šê¸°!!</div>
      <router-view></router-view>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    const currentDate = new Date().toLocaleString('ko-KR');
    console.log('currentDate:', currentDate); // í˜„ì¬ currentDate ê°’ ì¶œë ¥
    const [year, month, day] = currentDate.split('.').map(value => parseInt(value.trim()));
    console.log('year:', year, 'month:', month, 'day:', day); // year, month, day ê°’ ì¶œë ¥

    const formattedMonth = month < 10 ? `0${month}` : month.toString();
    console.log('formattedMonth:', formattedMonth); // formattedMonth ê°’ ì¶œë ¥
    const formattedDay = day < 10 ? `0${day}` : day.toString();
    console.log('formattedDay:', formattedDay); // formattedDay ê°’ ì¶œë ¥

    return {
      type: this.$route.query.type,
      selectedType: this.$route.query.selectedType, // ì´ˆê¸° ì„ íƒ íƒ€ì… ì„¤ì •
      name1: '',
      name2: '',
      date1_1: '',
      date1_2: '',
      date1_3: '',
      date2_1: year,
      date2_2: formattedMonth,
      date2_3: formattedDay,
      // date1: '1920-08-01',
      // date2: new Date().toISOString().substr(0, 10),
      date1Type: 'ì–‘ë ¥',
      date2Type: 'ì–‘ë ¥',
      showRouterView: this.$route.query.showRouterView,
    };
  },
  computed: {
    encodedName1() {
      const trimmedName1 = this.name1.trim();
      return trimmedName1 === '' ? 'í™ê¸¸ë™' : encodeURIComponent(trimmedName1);
    },
    defaultName1Placeholder() {
      // ì—¬ê¸°ì„œ ê¸°ë³¸ placeholder ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤
      return 'í™ê¸¸ë™';
    },
    encodedName2() {
      const trimmedName2 = this.name2.trim();

      if(this.type === 'ê¸°ë…êµ')
        return trimmedName2 === '' ? 'ì§ë¶„' : encodeURIComponent(trimmedName2);
      else if(this.type === 'ë¶ˆêµ')
        return trimmedName2 === '' ? 'ë²•ëª…' : encodeURIComponent(trimmedName2);
      else if(this.type === 'ì²œì£¼êµ')
        return trimmedName2 === '' ? 'ì„¸ë¡€ëª…' : encodeURIComponent(trimmedName2);

      return trimmedName2 === '' ? this.selectedType : encodeURIComponent(trimmedName2);
    },
    defaultName2Placeholder() {
      // ì—¬ê¸°ì„œ ê¸°ë³¸ placeholder ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤
      return this.selectedType;
    },
    showName1Warning() {
      const name1Length = this.name1.trim().length;
      return (name1Length < 2 || name1Length > 4) && name1Length !== 0;
    },
    showName1KoreanWarning() {
      // í•œê¸€ ë¬¸ìì— ëŒ€í•œ ì •ê·œì‹
      const koreanRegex= /^[ê°€-í£]*$/;
      const koreanConsonantVowelRegex = /^[ê°€-í£&&[^ã…-ã…£ã…‘-ã…£ã…“-ã…£ã…•-ã…£ã…—-ã…£ã…›-ã…£ã…œ-ã…£ã… -ã…£ã…¡-ã…£]]*$/;

      if(this.name1.length === 0)
        return false;

      // return !koreanRegex.test(this.name1);
      return !(koreanRegex.test(this.name1) && !koreanConsonantVowelRegex.test(this.name1));
    },
    showName2Warning() {
      const name2Length = this.name2.trim().length;
      return (name2Length < 2 || name2Length > 4) && name2Length !== 0;
    },
    showName3Warning() {
      const name2Length = this.name2.trim().length;
      return (name2Length < 2 || name2Length > 6) && name2Length !== 0;
    },
    showName2KoreanWarning() {
      // í•œê¸€ ë¬¸ìì— ëŒ€í•œ ì •ê·œì‹
      const koreanRegex= /^[ê°€-í£]*$/;
      const koreanConsonantVowelRegex = /^[ê°€-í£&&[^ã…-ã…£ã…‘-ã…£ã…“-ã…£ã…•-ã…£ã…—-ã…£ã…›-ã…£ã…œ-ã…£ã… -ã…£ã…¡-ã…£]]*$/;

      if(this.name2.length === 0)
        return false;

      // return !koreanRegex.test(this.name2);
      return !(koreanRegex.test(this.name2) && !koreanConsonantVowelRegex.test(this.name2));
    },
    encodedDate1() {
      if(this.date1_1 == '' || this.date1_2 == '' || this.date1_3 == '')
        return '1912-03-14';
      return this.date1_1 + '-' + this.date1_2 + '-' + this.date1_3;
    },
    encodedDate2() {
      return this.date2_1 + '-' + this.date2_2 + '-' + this.date2_3;
    },
    showDate1_2Warning(){
      const month = parseInt(this.date1_2);
      return month < 1 || month > 12;
    },
    showDate1_3Warning(){
      const month = parseInt(this.date1_2);
      const day = parseInt(this.date1_3);
      const maxDay = new Date(2023, month, 0).getDate();
      return day < 1 || day > maxDay;
    },
    showDate2_2Warning(){
      const month = parseInt(this.date2_2);
      return month < 1 || month > 12;
    },
    showDate2_3Warning(){
      const month = parseInt(this.date2_2);
      const day = parseInt(this.date2_3);
      const maxDay = new Date(2023, month, 0).getDate();
      return day < 1 || day > maxDay;
    },
  },
  methods: {
    toggleRouterView() {
      this.showRouterView = !this.showRouterView;
    },
  },
  // ë§¤ê°œë³€ìˆ˜ì˜ ë³€ê²½ ì‚¬í•­ì„ ê°ì§€
  watch: {
    'name1': function(newName1) {
      this.name1 = newName1;
    },
    'name2': function(newName2) {
      this.name2 = newName2;
    },
    '$route.query.type': function(newType) {
      this.type = newType;
    },
    '$route.query.selectedType': function(newSelectedType) {
      this.selectedType = newSelectedType;
    },
    '$route.query.showRouterView': function(newShowRouterView) {
      this.showRouterView = newShowRouterView;
    },
  },
};
</script>


<style>
/* @media (min-width: 1024px) {
  .about {
    min-height: 100vh;
    display: flex;
    align-items: center;
  }
} */

.info-text-align-center {
  display: inline-block;
  text-align: left;
}

.link-item-color {
  display: inline-block;
  justify-content: center;
  align-items: center;
  background-color: #cfcfcf; /* ë°°ê²½ìƒ‰ì„ ì„¤ì •í•©ë‹ˆë‹¤ */
  padding: 3px;
  margin-top: 2px;
  margin-bottom: 6px;
  border-radius: 5px;
}

.title3 {
  text-align: center;
  color: #baca11;
}

.title4 {
  font-size: 20px;
  font-family: "BMEULJIROTTF";
  color: red;
  cursor: pointer;
}

.title4_1 {
  color: pink;
}

.title5 {
  font-size: 20px;
  font-family: "BMEULJIROTTF";
  color: green;
  cursor: pointer;
}

.input-info1 {
  display: inline-block;
  justify-content: center;
  text-align: center;
  font-weight: bold;
  padding: 3px;
  /* background-color: rgb(81, 59, 59); */
}

.input-info2 {
  display: inline-block;
  justify-content: center;
  /* background-color: rgb(63, 103, 103); */
}

input::placeholder {
  text-align: center;
}

.warning_text{
  font-size: 18px;
  font-family: "BMEULJIROTTF";
  color: rgb(246, 63, 63);
}
</style>