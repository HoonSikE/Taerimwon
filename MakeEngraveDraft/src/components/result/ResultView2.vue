<template>
  <div class="">
    <router-link :to="'/engrave/engraveCreate/engraveDetail?type='
           + type + '&selectedType=' + selectedType + '&showRouterView=true'" class="title4">
          ğŸ‘‰ [ì´ì „ í˜ì´ì§€]
    </router-link>
    <div class="container">
      <!-- ê°ì¸ -->
      <div class="image-text-container">
        <div class="title2">â— ê°ì¸ ì˜ˆì‹œ 
          <div class="title6">&nbsp;&nbsp;- {{type}} 
            <span v-if="type !== selectedType"> [{{selectedType}}] </span>
          </div>
        </div>
        <div>
          <h4>ìº¡ì²˜í•œ ì´ë¯¸ì§€</h4>
          <img v-if="capturedImage" :src="capturedImage" alt="Captured" />
        </div>
        <div class="image-text-container1_1">
          <div v-if="imageContainerVisible" class="image-container1" :class="{ 'fullscreen1': isFullscreen1 }" @click="toggleFullscreen1" ref="imageContainer">
            <div v-if="type === 'ì¼ë°˜' && selectedType === 'ì¼ë°˜'">
              <img src="../../assets/images/engrave/background/ì¼ë°˜(ê³µ).png" height="100%" alt="ì¼ë°˜">
            </div>
            <div v-if="type === 'ì¼ë°˜' && selectedType === 'í˜•ì œ'">
              <img src="../../assets/images/engrave/background/ì¼ë°˜í˜•ì œ(ê³µ).png" height="100%" alt="í˜•ì œ">
            </div>
            <div v-if="type === 'ê¸°ë…êµ'">
              <img src="../../assets/images/engrave/background/ê¸°ë…êµ(ê³µ).png" height="100%" alt="ê¸°ë…êµ">
            </div>
            <div v-if="type === 'ë¶ˆêµ'">
              <img src="../../assets/images/engrave/background/ë¶ˆêµ(ê³µ).png" height="100%" alt="ë¶ˆêµ">
            </div>
            <div v-if="type === 'ì²œì£¼êµ'">
              <img src="../../assets/images/engrave/background/ì²œì£¼êµ(ê³µ).png" height="100%" alt="ì²œì£¼êµ">
            </div>
            <div v-if="type === 'SGI'">
              <img src="../../assets/images/engrave/background/sgi(ê³µ).png" height="100%" alt="SGI">
            </div>
            <div v-if="type === 'ë¬˜ë²•'">
              <img src="../../assets/images/engrave/background/ë¬˜ë²•(ê³µ).png" height="100%" alt="ë¬˜ë²•">
            </div>
            <div class="text-container">
              <span class="resultText1">
                <span class="resultText1_1">{{date1_1}}</span>
                <span class="resultText1_2">â€¢</span>
                <span class="resultText1_1">{{date1_2}}</span>
                <span class="resultText1_2">â€¢</span>
                <span class="resultText1_1">{{date1_3}}</span>
                <span v-if="date1Type==='ìŒë ¥'" class="resultText1_3">é™°</span>
                <span v-if="date1Type==='ì–‘ë ¥'" class="resultText1_3">é™½</span>
              </span>
              <!-- <div v-if="selectedType === 'ì¼ë°˜'"> -->
              <!-- ê·¸ëŒ€ë¡œ -->
              <span class="" v-if="selectedType === 'ì¼ë°˜' || selectedType === 'ê¸°ë…êµ' || selectedType === 'ë¶ˆêµ'
                                        || selectedType === 'ì²œì£¼êµ'">
                <span class="resultText2" v-if="name1.length === 2 || name1.length === 3">
                  {{encodedName1}}
                </span>
                <span class="resultText2-4" v-if="name1.length === 4">
                  {{encodedName1}}
                </span>
              </span>
              <!-- ì•„ë˜ ê¸€ì 1 -->
              <span class="" v-if="selectedType === 'í˜•ì œ'">
                <span class="resultText2_1" v-if="name1.length === 2 || name1.length === 3">
                  {{encodedName1}}
                </span>
                <span class="resultText2_1-4" v-if="name1.length === 4">
                  {{encodedName1}}
                </span>
              </span>
              <!-- ìœ„ ê¸€ì 1 -->
              <span class="" v-if="selectedType === 'SGI'">
                <span class="resultText2_2" v-if="name1.length === 2 || name1.length === 3">
                  {{encodedName1}}
                </span>
                <span class="resultText2_2-4" v-if="name1.length === 4">
                  {{encodedName1}}
                </span>
              </span>
              <!-- ìœ„ ì•„ë˜ ê¸€ì -->
              <span class="" v-if="selectedType === 'ë¬˜ë²•'">
                <span class="resultText2_3" v-if="name1.length === 2 || name1.length === 3">
                  {{encodedName1}}
                </span>
                <span class="resultText2_3-4" v-if="name1.length === 4">
                  {{encodedName1}}
                </span>
              </span>
              <!-- ì•„ë˜ ê¸€ì 2 -->
              <span class="resultText2_4" v-if="selectedType === 'ì„¸ë¡€ëª…'">
                <span class="resultText2_4_1" v-if="name1.length === 2 || name1.length === 3">
                  {{encodedName1}}
                </span>
                <span class="resultText2_4_1-4" v-if="name1.length === 4">
                  {{encodedName1}}
                </span>
                <span class="resultText2_4_2" v-if="name2.length === 2 || name2.length === 3">
                  {{name2}}
                </span>
                <span class="resultText2_4_2-4" v-if="name2.length === 4">
                  {{name2}}
                </span>
                <span class="resultText2_4_2-5" v-if="name2.length === 5">
                  {{name2}}
                </span>
                <span class="resultText2_4_2-6" v-if="name2.length === 6">
                  {{name2}}
                </span>
              </span>
              <!-- ìœ„ ê¸€ì 2-->
              <span class="resultText2_5" v-if="selectedType === 'ì§ë¶„' || selectedType === 'ë²•ëª…'">
                <span class="resultText2_5_2" v-if="name2.length === 2 || name2.length === 3">
                  {{name2}}
                </span>
                <span class="resultText2_5_2-4" v-if="name2.length === 4">
                  {{name2}}
                </span>

                <span class="resultText2_5_1" v-if="name1.length === 2 || name1.length === 3">
                  {{encodedName1}}
                </span>
                <span class="resultText2_5_1-4" v-if="name1.length === 4">
                  {{encodedName1}}
                </span>
              </span>
              <!-- </div> -->
              <span class="resultText1">
                <span class="resultText1_1">{{date2_1}}</span>
                <span class="resultText1_2">â€¢</span>
                <span class="resultText1_1">{{date2_2}}</span>
                <span class="resultText1_2">â€¢</span>
                <span class="resultText1_1">{{date2_3}}</span>
                <span v-if="date2Type==='ìŒë ¥'" class="resultText1_3">é™°</span>
                <span v-if="date2Type==='ì–‘ë ¥'" class="resultText1_3">é™½</span>
              </span>
            </div>
          </div>
        </div>
      </div>
      <!-- ìœ„íŒ¨ -->
      <div class="image-text-container2" v-if="selectedType2 !== 'ì—†ìŒ'">
        <div class="title2">â— ìœ„íŒ¨ ì˜ˆì‹œ
          <div class="title6">&nbsp;&nbsp;- {{type}} 
            <span v-if="name0 !== 'ì—†ìŒ'"> [ë³¸ê´€] </span>
          </div>
        </div>
        <div class="image-text-container1_2">
          <div class="image-container2" :class="{ 'fullscreen2': isFullscreen2 }" @click="toggleFullscreen2">
            <div v-if="name0 !== 'ì—†ìŒ'">
              <div v-if="type === 'ì¼ë°˜'">
                <img src="../../assets/images/memorialTablet/background/ë³¸ê´€ì¶œë ¥ì‹œì•ˆ/ì¼ë°˜(ë³¸ê´€ì¶œë ¥ì‹œì•ˆ).png" height="100%" alt="ì¼ë°˜">
              </div>
              <div v-if="type === 'ê¸°ë…êµ'">
                <img src="../../assets/images/memorialTablet/background/ë³¸ê´€ì¶œë ¥ì‹œì•ˆ/ê¸°ë…êµ(ë³¸ê´€ì¶œë ¥ì‹œì•ˆ).png" height="100%" alt="ê¸°ë…êµ">
              </div>
              <div v-if="type === 'ë¶ˆêµ'">
                <img src="../../assets/images/memorialTablet/background/ë³¸ê´€ì¶œë ¥ì‹œì•ˆ/ë¶ˆêµ(ë³¸ê´€ì¶œë ¥ì‹œì•ˆ).png" height="100%" alt="ë¶ˆêµ">
              </div>
              <div v-if="type === 'ì²œì£¼êµ'">
                <img src="../../assets/images/memorialTablet/background/ë³¸ê´€ì¶œë ¥ì‹œì•ˆ/ì²œì£¼êµ(ë³¸ê´€ì¶œë ¥ì‹œì•ˆ).png" height="100%" alt="ì²œì£¼êµ">
              </div>
            </div>
            <div v-else>
              <div v-if="type === 'ì¼ë°˜'">
                <img src="../../assets/images/memorialTablet/background/ì´ë¦„ì¶œë ¥ì‹œì•ˆ/ì¼ë°˜(ì´ë¦„ì¶œë ¥ì‹œì•ˆ).png" height="100%" alt="ì¼ë°˜">
              </div>
              <div v-if="type === 'ê¸°ë…êµ'">
                <img src="../../assets/images/memorialTablet/background/ì´ë¦„ì¶œë ¥ì‹œì•ˆ/ê¸°ë…êµ(ì´ë¦„ì¶œë ¥ì‹œì•ˆ).png" height="100%" alt="ê¸°ë…êµ">
              </div>
              <div v-if="type === 'ë¶ˆêµ'">
                <img src="../../assets/images/memorialTablet/background/ì´ë¦„ì¶œë ¥ì‹œì•ˆ/ë¶ˆêµ(ì´ë¦„ì¶œë ¥ì‹œì•ˆ).png" height="100%" alt="ë¶ˆêµ">
              </div>
              <div v-if="type === 'ì²œì£¼êµ'">
                <img src="../../assets/images/memorialTablet/background/ì´ë¦„ì¶œë ¥ì‹œì•ˆ/ì²œì£¼êµ(ì´ë¦„ì¶œë ¥ì‹œì•ˆ).png" height="100%" alt="ì²œì£¼êµ">
              </div>
            </div>
            <div class="text-container2">
              <!-- <span class="resultText3"> -->
              <!-- ìœ„íŒ¨ ì¶”ê°€ -->
              <div v-if="selectedType2 !== 'ì—†ìŒ'">
                <!-- ë³¸ê´€ ì„ íƒ o -->
                <div v-if="name0 !== 'ì—†ìŒ'">
                  <!-- ì¼ë°˜ -->
                  <span class="resultText4_1_1" v-if="type === 'ì¼ë°˜'">
                    {{name0}}
                  </span>
                  <!-- ë¶ˆêµ -->
                  <span class="resultText4_1_2" v-if="type === 'ë¶ˆêµ'">
                    {{name0}}
                  </span>
                  <!-- ìœ„ ê¸€ì -->
                  <span class="resultText4_2" v-if="type === 'ê¸°ë…êµ'">
                    <span class="resultText4_2_2">{{name2}}</span>
                    <span class="resultText4_2_1">{{name0}}</span>
                  </span>
                  <!-- ì•„ë˜ ê¸€ì -->
                  <span class="resultText4_3" v-if="type === 'ì²œì£¼êµ'">
                    <span class="resultText4_3_1">{{name0}}</span>
                    <span class="resultText4_3_2" v-if="name2.length === 2 || name2.length === 3">
                      {{name2}}
                    </span>
                    <span class="resultText4_3_2" v-if="name2.length === 4">
                      {{name2}}
                    </span>
                    <span class="resultText4_3_2" v-if="name2.length === 5">
                      {{name2}}
                    </span>
                    <span class="resultText4_3_2-6" v-if="name2.length === 6">
                      {{name2}}
                    </span>
                  </span>
                </div>
                <!-- ë³¸ê´€ ì„ íƒ x-->
                <div v-else>
                  <!-- ì¼ë°˜ -->
                  <span class="" v-if="type === 'ì¼ë°˜' || type === 'ë¶ˆêµ'">
                    <span class="resultText3_1" v-if="name1.length === 2 || name1.length === 3">
                      {{encodedName1}}
                    </span>
                    <span class="resultText3_1-4" v-if="name1.length === 4">
                      {{encodedName1}}
                    </span>
                  </span>
                  <!-- ìœ„ ê¸€ì -->
                  <span class="resultText3_2" v-if="type === 'ê¸°ë…êµ'">
                    <span class="resultText3_2_2" v-if="name2.length === 2 || name2.length === 3">
                      {{name2}}
                    </span>
                    <span class="resultText3_2_2-4" v-if="name2.length === 4">
                      {{name2}}
                    </span>
                    <span class="resultText3_2_1" v-if="name1.length === 2 || name1.length === 3">
                      {{encodedName1}}
                    </span>
                    <span class="resultText3_2_1-4" v-if="name1.length === 4">
                      {{encodedName1}}
                    </span>
                  </span>
                  <!-- ì•„ë˜ ê¸€ì -->
                  <span class="resultText3_3" v-if="type === 'ì²œì£¼êµ'">
                    <span class="resultText3_3_1" v-if="name1.length === 2 || name1.length === 3">
                      {{encodedName1}}
                    </span>
                    <span class="resultText3_3_1-4" v-if="name1.length === 4">
                      {{encodedName1}}
                    </span>
                    <span class="resultText3_3_2" v-if="name2.length === 2 || name2.length === 3">
                      {{name2}}
                    </span>
                    <span class="resultText3_3_2-4" v-if="name2.length === 4">
                      {{name2}}
                    </span>
                    <span class="resultText3_3_2-5" v-if="name2.length === 5">
                      {{name2}}
                    </span>
                    <span class="resultText3_3_2-6" v-if="name2.length === 6">
                      {{name2}}
                    </span>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <br>
    </div>
    <div>
      ê°ì¸ ì¢…ë¥˜: {{this.type}}<br>
      ìƒì„¸ ì¢…ë¥˜: {{this.selectedType}}<br>
      <div v-if="selectedType === 'ì§ë¶„' || selectedType === 'ë²•ëª…' || selectedType === 'ì„¸ë¡€ëª…'">
        {{this.selectedType}}ëª…: {{this.name2}}<br>
      </div>
      <hr>
      ê³ ì¸ ì„±í•¨: {{this.name1}}<br>
      ì¶œìƒì¼: {{this.date1}} {{this.date1Type}}<br>
      ì‚¬ë§ì¼: {{this.date2}} {{this.date2Type}}<br>
      <hr>
      <div v-if="selectedType2 === 'ì—†ìŒ'">
        ìœ„íŒ¨ ìœ ë¬´: X<br>
      </div>
      <div v-else>
        ìœ„íŒ¨ ìœ ë¬´: O<br>
        <div v-if="name0 !== 'ì—†ìŒ'">
          ìœ„íŒ¨ ì¢…ë¥˜: ë³¸ê´€<br>
          ë³¸ê´€ ë‚´ìš©: {{this.name0}}<br>
        </div>
        <div v-else>
          ìœ„íŒ¨ ì¢…ë¥˜: ì¼ë°˜<br>
          <div v-if="selectedType === 'ì§ë¶„' || selectedType === 'ë²•ëª…' || selectedType === 'ì„¸ë¡€ëª…'">
            {{this.selectedType}}ëª…: {{this.name2}}<br>
          </div>
          ê³ ì¸ ì„±í•¨: {{this.name1}}<br>
        </div>
      </div>
    </div>


    <button @click="captureAndDisplay">ìº¡ì²˜ ë° ì¶œë ¥</button>

    


    <a v-if="isIOS" class="title8" :href="iosSMSEntry">ì•„ì´í° SMS ë³´ë‚´ê¸°</a>
    <a v-if="isAndroid" class="title8" :href="androidSMSEntry">ì•ˆë“œë¡œì´ë“œ SMS ë³´ë‚´ê¸°</a><br>
    <!-- <a v-if="isAndroid" class="title8" :href="androidMMSEntry">ì•ˆë“œë¡œì´ë“œ MMS ë³´ë‚´ê¸°</a> -->
    <a v-if="isUnknown" class="title8">ë¬¸ìí˜¸í™˜ë˜ì§€ ì•ŠëŠ” ê¸°ì¢…ì…ë‹ˆë‹¤.</a>
  </div>
</template>

<script>
import html2canvas from 'html2canvas';

export default {
  data() {
    return {
      type: this.$route.query.type,
      name0: this.$route.query.name0,
      name1: this.$route.query.name1,
      name2: this.$route.query.name2,
      date1: this.$route.query.date1,
      date1Type: this.$route.query.date1Type,
      date2: this.$route.query.date2,
      date2Type: this.$route.query.date2Type,
      selectedType: this.$route.query.selectedType, // ì´ˆê¸° ì„ íƒ íƒ€ì… ì„¤ì •
      selectedType2: this.$route.query.selectedType2, // ì´ˆê¸° ì„ íƒ íƒ€ì… ì„¤ì •

      date1_1: this.$route.query.date1.substr(0,4),
      date1_2: this.$route.query.date1.substr(5,2),
      date1_3: this.$route.query.date1.substr(8,2),
      date2_1: this.$route.query.date2.substr(0,4),
      date2_2: this.$route.query.date2.substr(5,2),
      date2_3: this.$route.query.date2.substr(8,2),

      isFullscreen1: false,
      isFullscreen2: false,

      capturedImage: null,
      imageContainerVisible: true,
    };
  },
  computed: {
    encodedName1() {
      const trimmedName1 = this.name1.trim();

      if(trimmedName1.length === 2){
        return trimmedName1.substr(0, 1) + " " + trimmedName1.substr(1, 1);
      }
      return trimmedName1;
    },
    isIOS() {
      return this.checkMobile() === 'ios';
    },
    iosSMSEntry() {
      const phoneNumber = '01045097485';

      const message = encodeURIComponent(this.getMsg());
      return `sms:${phoneNumber}&body=${message}`;
    },
    isAndroid() {
      return this.checkMobile() === 'android';
    },
    androidSMSEntry() {
      const phoneNumber = '01045097485';
      const message = encodeURIComponent(this.getMsg());
      return `sms:${phoneNumber}?body=${message}`;
    },
    isUnknown() {
      return this.checkMobile() === 'unknown';
    },
  },
  mounted() {
    // this.captureAndDisplay();
  },
  methods: {
    checkMobile() {
      // í˜„ì¬ ì‚¬ìš©ì ê¸°ê¸°ê°€ iOSì¸ì§€ Androidì¸ì§€ í™•ì¸í•˜ëŠ” ë©”ì„œë“œ
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;
      if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
        return "ios";
      } else if (/android/i.test(userAgent)) {
        return "android";
      }
      return "unknown";
    },
    toggleFullscreen1() {
      this.isFullscreen1 = !this.isFullscreen1;
      if (this.isFullscreen1) {
        this.zoomIn1();
      } else {
        this.zoomOut1();
      }
    },
    zoomIn1() {
      const imageContainer = document.querySelector('.image-container1');
      imageContainer.style.transform = 'scale(2)'; // ì˜ˆì‹œë¡œ í™•ëŒ€ ë°°ìœ¨ì„ 2ë°°ë¡œ ì„¤ì •

      const textContainer = document.querySelector('.text-container');
      textContainer.style.transform = 'translate(-100%, 12%)';
    },
    zoomOut1() {
      const imageContainer = document.querySelector('.image-container1');
      imageContainer.style.transform = 'scale(1)'; // ì›ë˜ í¬ê¸°ë¡œ ì„¤ì •

      const textContainer = document.querySelector('.text-container');
      textContainer.style.transform = 'translate(0%, -107%)';
    },
    toggleFullscreen2() {
      this.isFullscreen2 = !this.isFullscreen2;
      if (this.isFullscreen2) {
        this.zoomIn2();
      } else {
        this.zoomOut2();
      }
    },
    zoomIn2() {
      const imageContainer = document.querySelector('.image-container2');
      imageContainer.style.transform = 'scale(2)'; // ì˜ˆì‹œë¡œ í™•ëŒ€ ë°°ìœ¨ì„ 2ë°°ë¡œ ì„¤ì •

      const textContainer = document.querySelector('.text-container2');
      textContainer.style.transform = 'translate(-100%, 12%)';
    },
    zoomOut2() {
      const imageContainer = document.querySelector('.image-container2');
      imageContainer.style.transform = 'scale(1)'; // ì›ë˜ í¬ê¸°ë¡œ ì„¤ì •

      const textContainer = document.querySelector('.text-container2');
      textContainer.style.transform = 'translate(0%, -100%)';
    },
    getMsg() {
      var msg = '[ê°ì¸ ì£¼ë¬¸]\n'
        + 'ê°ì¸ ì¢…ë¥˜: ' + this.type + '\nìƒì„¸ ì¢…ë¥˜: ' + this.selectedType;
        
      if(this.selectedType === 'ì§ë¶„' || this.selectedType === 'ë²•ëª…' || this.selectedType === 'ì„¸ë¡€ëª…')
        msg += '\n' + this.selectedType + 'ëª…: ' + this.name2;

      msg += '\n\nê³ ì¸ ì„±í•¨: ' + this.name1
        + '\nì¶œìƒì¼: ' + this.date1 + ' ' + this.date1Type 
        + '\nì‚¬ë§ì¼: ' + this.date2 + ' ' + this.date2Type;

      if(this.selectedType2 == 'ì—†ìŒ')
        msg += '\nìœ„íŒ¨ ìœ ë¬´: X';
      else {
        msg += '\nìœ„íŒ¨ ìœ ë¬´: O';
        if(this.name0 !== 'ì—†ìŒ'){
          msg += '\nìœ„íŒ¨ ì¢…ë¥˜: ë³¸ê´€' + '\në³¸ê´€ ë‚´ìš©: ' + this.name0;
        }else{
          msg += '\nìœ„íŒ¨ ì¢…ë¥˜: ì¼ë°˜';
          if(this.selectedType === 'ì§ë¶„' || this.selectedType === 'ë²•ëª…' || this.selectedType === 'ì„¸ë¡€ëª…')
            msg += '\n' + this.selectedType + 'ëª…: ' + this.name2;
          msg += '\nê³ ì¸ ì„±í•¨: ' + this.name1;
        }
      }
      console.log(msg);

      return msg;
    },
    async captureAndDisplay() {
      const imageContainer = this.$refs.imageContainer;

      // ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆ ìº¡ì²˜
      const canvas = await html2canvas(imageContainer);
      const capturedImageDataUrl = canvas.toDataURL("image/png");

      this.capturedImage = capturedImageDataUrl;
      this.imageContainerVisible = !this.imageContainerVisible; // ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆë¥¼ ìˆ¨ê¹€
    },
  },
};
</script>
